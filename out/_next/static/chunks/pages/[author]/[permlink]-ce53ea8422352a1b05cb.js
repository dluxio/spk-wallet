(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[747],{73948:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var s=n(83789),i=n(80318),r=n(67294),a=n(11163),l=n(60590),c=n.n(l),o=n(87893),u=n(43196),d=n(2804),m=n(63569),f=n(89583),p=n(60155),x=n(45051),h=n(85893),g=function(e){var t=e.comment,n=(0,d.sJ)(m.KL),s=(0,a.useRouter)(),i=new o.Client(x.ZA),l=(0,r.useState)(x.$8),c=l[0],g=l[1],v=(0,r.useState)(!1),j=v[0],y=v[1],N=(0,r.useState)(""),w=N[0],b=N[1],k=(0,r.useState)("#000"),S=k[0],_=k[1];(0,r.useEffect)((function(){var e=document.getElementById("comment-body-".concat(t.id));e&&(e.innerHTML=t.body),i.database.getAccounts([t.author]).then((function(e){g(JSON.parse(e[0].posting_json_metadata).profile.profile_image)}))}),[]);return(0,h.jsxs)("div",{className:"text-white bg-gray-600 p-4 rounded-xl border-2 border-gray-800",children:[(0,h.jsxs)("div",{className:"flex gap-2 items-center mb-2",children:[(0,h.jsx)("img",{src:c,className:"rounded-full border-2 border-gray-800",height:45,width:45,alt:"profile_picture"}),(0,h.jsx)("h1",{onClick:function(){return s.push("/@".concat(t.author))},className:"text-xl hover:text-gray-700 transition-all cursor-pointer",children:t.author})]}),(0,h.jsxs)("div",{className:"text-white mr-1 ml-2 whitespace-pre-wrap break-words",children:[(0,h.jsx)("div",{id:"comment-body-".concat(t.id)}),(0,h.jsxs)("div",{className:"w-auto",children:[(0,h.jsx)("div",{className:"flex",children:(0,h.jsxs)("div",{onClick:function(){return y(!j)},className:"hover:bg-gray-700 px-2 py-1 my-1 rounded-xl cursor-pointer flex items-center gap-2",children:[(0,h.jsx)(f.Bjt,{size:20,color:"#fff",className:"my-3"}),"(",t.replies.length,")"]})}),j&&(0,h.jsxs)("div",{className:"relative flex w-1/2",children:[(0,h.jsx)("input",{type:"text",className:"text-black w-full outline-none p-2 rounded-xl my-2",placeholder:"Write a reply",onChange:function(e){return b(e.target.value)}}),(0,h.jsx)(p.yhK,{color:S,size:25,onMouseEnter:function(){return _("#dcdcdc")},onMouseLeave:function(){return _("#000")},onClick:function(){(0,u.Hi)({author:n.name,body:w,parent_author:t.author,parent_permlink:t.permlink,permlink:"re-previous-".concat(t.author,"-").concat(t.permlink)})},className:"absolute right-4 top-4 cursor-pointer"})]})]})]}),t.replies.map((function(e){var n=document.getElementById("comment-body-".concat(t.id,"-replie-").concat(e.id));return n&&(n.innerHTML=e.body),(0,h.jsxs)("div",{className:"mx-3",children:[(0,h.jsx)("h1",{onClick:function(){return s.push("/@".concat(t.author))},className:"text-xl font-semibold text-white hover:text-gray-700 cursor-pointer",children:e.author}),(0,h.jsx)("h1",{id:"comment-body-".concat(t.id,"-replie-").concat(e.id),className:"text-white mx-2"})]},e.id)}))]})},v=n(47320),j=n(37039),y=function(){var e,t=new o.Client(x.ZA),n=(0,r.useState)(0),l=n[0],y=n[1],N=(0,r.useState)(""),w=N[0],b=N[1],k=(0,r.useState)([]),S=k[0],_=k[1],C=(0,r.useState)(null),E=C[0],H=C[1],A=(0,r.useState)(!1),J=A[0],L=A[1],O=(0,r.useState)("#000"),I=O[0],z=O[1],M=(0,r.useState)(!1),Z=M[0],T=M[1],B=(0,r.useState)([]),D=B[0],K=B[1],X=(0,r.useState)(!1),$=X[0],q=X[1],U=(0,r.useState)(""),F=U[0],P=U[1],R=(0,r.useState)(!1),V=R[0],G=R[1],W=(0,r.useState)(""),Q=W[0],Y=W[1],ee=(0,r.useState)([]),te=ee[0],ne=ee[1],se=(0,d.FV)(m.D2),ie=(0,i.Z)(se,2),re=(ie[0],ie[1]),ae=(0,r.useState)(null),le=ae[0],ce=ae[1],oe=(0,d.FV)(m.Lf),ue=(0,i.Z)(oe,2),de=ue[0],me=ue[1],fe=(0,a.useRouter)(),pe=(0,d.sJ)(m.KL),xe=fe.query,he=xe.permlink,ge=xe.author,ve=(0,j.$G)().t;(0,r.useEffect)((function(){if(V){document.title="DLUX | ".concat(le.title);var e=le.json_metadata,t=JSON.parse(e).vrHash,n=JSON.parse(e).scrolling,s=location.href.split("?")[1],i=document.createElement("iframe");i.id="theIframe",i.setAttribute("scrolling",n||"yes"),i.width="100%",i.height="100%",i.setAttribute("allowfullscreen","true"),i.setAttribute("allow","gyroscope; accelerometer; microphone; camera"),i.src="".concat(de,"ipfs/").concat(t,"?").concat(s),document.getElementById("iframe-app")&&document.getElementById("iframe-app").appendChild(i)}}),[V]);var je=function(){(0,u.Ns)(pe.name,Q,he,l).then((function(e){e&&e.success&&re((function(t){return[].concat((0,s.Z)(t),[e])}))}))};(0,r.useEffect)((function(){if(ge&&"@"===ge.slice(0,1)){if("https://anywhere.ipfs.dlux.io/"===de){var e=ge.slice(1,ge.length).replace(".","-");me("https://".concat(e,".ipfs.dlux.io/"))}Y(ge.slice(1,ge.length))}}),[]);(0,r.useEffect)((function(){""!==Q&&(c().api.getContent(Q,he,(function(e,t){e&&console.log(e),ce(t),H(JSON.parse(t.json_metadata))})),t.database.call("get_content_replies",[Q,he]).then((function(e){ne(e)})))}),[Q]),(0,r.useEffect)((function(){if(E){var e=[];if(E.image.forEach((function(t,n){e.push({id:n,url:t})})),0!==e.length&&K(e),E.app.includes("3speak")){L(!0);var t="https://ipfs.io/ipfs/"+E.video.info.ipfs,n="https://ipfs.io/ipfs/"+E.video.info.ipfsThumbnail;n&&t&&_((function(e){return[].concat((0,s.Z)(e),[{file:t,image:n}])}))}else{var i;(i=E.image&&Array.isArray(E.image)?E.image[0]:"string"==typeof E.image?E.image:E.Hash360&&(E.Hash360,1)?"https://ipfs.io/ipfs/".concat(E.Hash360):"https://www.dlux.io/img/dlux-sdk.png")&&"https"!==i.substr(0,5)&&(i="https://www.dlux.io/img/dlux-sdk.png"),P(i)}}}),[E]);(0,r.useMemo)((function(){return D.map((function(e){return{key:String(e.id),children:(0,h.jsx)("div",{style:{backgroundImage:"url(".concat(e.url,")")}})}}))}),[D]);return V?(0,h.jsxs)("div",{className:"w-full h-screen fixed top-0 left-0 bg-black text-white text-2xl font-bold bg-opacity-70",children:[(0,h.jsxs)("div",{className:"flex px-10 justify-between w-full bg-blue-500",children:[(0,h.jsx)("span",{className:"hover:text-gray-500 cursor-pointer",onClick:function(){document.querySelectorAll("iframe").forEach((function(e){return e.remove()})),G(!1)},children:"DLUX"}),(0,h.jsx)("span",{children:null===le||void 0===le?void 0:le.title})]}),(0,h.jsx)("div",{className:"w-full h-full",id:"iframe-app"})]}):le&&(0,h.jsx)("div",{className:"w-full mx-auto max-w-3xl",children:(0,h.jsxs)("div",{className:"flex justify-evenly flex-col w-full mt-10",children:[J?(0,h.jsx)("div",{className:"w-full flex justify-center my-2",children:(0,h.jsx)(v.Z,{className:"rounded-xl w-4/5",playerId:"my-unique-id",playerScript:"https://cdn.jwplayer.com/libraries/HT7Dts3H.js",playlist:S})}):(0,h.jsx)("div",{className:"flex justify-center w-full my-2",children:(0,h.jsx)("img",{src:F,alt:"thumbnail"})}),JSON.parse(le.json_metadata).vrHash&&(0,h.jsx)("button",{className:"mx-auto px-4 py-2 rounded-lg border-2 text-white bg-blue-500 border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-700",onClick:function(){return G(!0)},children:ve("runApp")}),(0,h.jsxs)("div",{className:"p-5",children:[(0,h.jsx)("h1",{className:"text-white text-3xl",children:null===le||void 0===le?void 0:le.title}),(0,h.jsx)("h1",{className:"text-white text-center sm:mx-3 sm:text-left text-lg cursor-pointer",children:null===(e=JSON.parse(le.json_metadata))||void 0===e?void 0:e.description}),(0,h.jsxs)("div",{className:"flex items-center w-full my-5 mx-2 gap-2",children:[Z?(0,h.jsxs)("div",{onClick:je,className:"flex text-white mx-1 gap-2 rounded-xl px-2 py-1 bg-green-500 cursor-pointer",children:[(0,h.jsx)(f.$0H,{size:25,color:"#fff"}),l/100,"%"]}):(0,h.jsx)("div",{className:"px-2 py-1 cursor-pointer",children:(0,h.jsx)(f.$0H,{size:25,color:"#fff",onClick:function(){q(!1),T(!0)}})}),$?(0,h.jsxs)("div",{onClick:je,className:"flex text-white mx-1 gap-2 rounded-xl px-2 py-1 bg-red-500 cursor-pointer",children:[(0,h.jsx)(f.c0u,{size:25,color:"#fff"}),l/100,"%"]}):(0,h.jsx)("div",{className:"px-2 py-1 cursor-pointer",children:(0,h.jsx)(f.c0u,{size:25,color:"#fff",onClick:function(){T(!1),q(!0)}})}),(0,h.jsxs)("h1",{className:"text-white text-xl cursor-pointer",onClick:function(){T(!1),q(!1)},children:["(",le.active_votes.length,")"]})]}),(0,h.jsxs)("div",{className:"w-full",children:[Z&&(0,h.jsx)("input",{className:"my-2 w-full",onChange:function(e){return y(+e.target.value)},type:"range",min:"0",max:"10000",value:"0"}),$&&(0,h.jsx)("input",{className:"my-2 w-full",onChange:function(e){return y(+e.target.value)},type:"range",min:"0",max:"10000",value:"0"})]}),(0,h.jsxs)("div",{className:"my-2",children:[(0,h.jsx)("h1",{className:"text-white border-b-2 border-white pb-1 text-2xl",children:ve("comments")}),(0,h.jsxs)("div",{className:"relative flex",children:[(0,h.jsx)("input",{type:"text",className:"w-full outline-none p-2 rounded-xl my-2",placeholder:ve("writeComment"),onChange:function(e){return b(e.target.value)}}),(0,h.jsx)(p.yhK,{color:I,size:25,onMouseEnter:function(){return z("#dcdcdc")},onMouseLeave:function(){return z("#000")},onClick:function(){w&&(0,u.UI)({author:pe.name,title:"",body:w,parent_author:Q,parent_permlink:he,permlink:"re-previous-".concat(Q,"-").concat(he),json_metadata:JSON.stringify({tags:["hiveio"]})}),b("")},className:"absolute right-4 top-4 transition-all cursor-pointer"})]}),(0,h.jsx)("div",{className:"flex flex-col justify-center gap-3 my-3",children:te.map((function(e){return(0,h.jsx)(g,{comment:e},e.id)}))})]})]})]})})}},71425:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[author]/[permlink]",function(){return n(73948)}])}},function(e){e.O(0,[260,774,888,179],(function(){return t=71425,e(e.s=t);var t}));var t=e.O();_N_E=t}]);